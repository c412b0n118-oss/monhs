<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>WEBGIS PATROLI HUTAN</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
#map{
height:100vh;
}

.popupimg{
width:200px;
border-radius:8px;
margin-top:5px;
}
</style>
</head>

<body>
<div id="map"></div>

<script>

var map = L.map('map').setView([-0.85,110.43],9);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
attribution:'WebGIS Patroli'
}).addTo(map);

// ===== ICON =====
var fireIcon = L.icon({
iconUrl:'https://cdn-icons-png.flaticon.com/512/482/482367.png',
iconSize:[28,28]
});

var patrolIcon = L.icon({
iconUrl:'https://cdn-icons-png.flaticon.com/512/854/854878.png',
iconSize:[28,28]
});

var illegalIcon = L.icon({
iconUrl:'https://cdn-icons-png.flaticon.com/512/684/684908.png',
iconSize:[28,28]
});

// ===== DATABASE =====
const url = "https://opensheet.elk.sh/1pIX0zdicQMOHpS8Zagrt5gTlUPbAXggdtDDfxVBFWu4/Sheet1";

fetch(url)
.then(res=>res.json())
.then(data=>{

data.forEach(row=>{

if(row.lat && row.lon){

let icon = patrolIcon;

if(row.aktivitas=="Hotspot" || row.aktivitas=="Bekas Kebakaran"){
icon = fireIcon;
}

if(row.aktivitas=="Illegal Logging" || row.aktivitas=="Perburuan"){
icon = illegalIcon;
}

let fotoHTML = "";
if(row.foto){
fotoHTML = `<br><img src="${row.foto}" class="popupimg">`;
}

L.marker([parseFloat(row.lat),parseFloat(row.lon)],{icon:icon})
.addTo(map)
.bindPopup(`
<b>${row.nama_petugas}</b><br>
Aktivitas: ${row.aktivitas}<br>
Tanggal: ${row.tanggal}<br>
${row.keterangan}
${fotoHTML}
`);

}

});

});

</script>
</body>
</html>